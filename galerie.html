<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galerie | Thomas Soleil</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
</head>
<body>

    <nav>
        <a href="index.html" class="logo">Thomas Soleil</a>
        <div class="nav-links">
            <a href="index.html">Albums</a>
            <a href="a-propos.html">À Propos</a>
            <a href="contact.html">Contact</a>
        </div>
    </nav>

    <main>
        <div class="gallery-header">
            <a href="index.html" class="back-link">← Retour aux albums</a>
            <h1 id="album-title">Chargement...</h1>
            <p id="album-meta" style="color: #666; font-style: italic;"></p>
        </div>

        <div class="masonry" id="gallery-container"></div>
    </main>

    <div id="lightbox" onclick="this.style.display='none'">
        <img id="lightbox-img" src="">
    </div>

    <script src="js/config.js"></script>
    <script>
        // 1. Récupération de l'album
        const params = new URLSearchParams(window.location.search);
        const albumId = params.get('id');
        const album = siteConfig.albums.find(a => a.id === albumId);

        if (album) {
            // 2. Remplissage des infos (Sans le nombre de photos)
            document.title = `${album.title} | Thomas Soleil`;
            document.getElementById('album-title').innerText = album.title;
            
            // On affiche juste la date (ex: "2024")
            document.getElementById('album-meta').innerText = album.date;

            const container = document.getElementById('gallery-container');
            
            // 3. FONCTION "DÉTECTIVE" (Charge les images une par une)
            let index = 1;

            function loadNextImage() {
                // On crée une image virtuelle pour tester si elle existe
                const imgTest = new Image();
                const src = `${album.folder}/${album.prefix}${index}.jpg`;
                imgTest.src = src;

                imgTest.onload = function() {
                    // SUCCÈS : L'image existe !
                    
                    // Création de la case
                    const div = document.createElement('div');
                    div.className = 'photo-item';
                    
                    // Création de l'image affichée
                    const img = document.createElement('img');
                    img.src = src;
                    img.alt = `${album.title} ${index}`;
                    img.loading = "lazy";

                    // Zoom au clic
                    div.onclick = () => {
                        document.getElementById('lightbox-img').src = src;
                        document.getElementById('lightbox').style.display = 'flex';
                    };

                    // Animation d'apparition douce
                    img.onload = () => div.classList.add('visible');

                    div.appendChild(img);
                    container.appendChild(div);

                    // On passe à la suivante
                    index++;
                    loadNextImage();
                };

                imgTest.onerror = function() {
                    // ERREUR : L'image n'existe pas, c'est la fin de l'album.
                    console.log("Fin de l'album détectée après " + (index - 1) + " photos.");
                };
            }

            // Lancer le processus avec la première image
            loadNextImage();

        } else {
            document.getElementById('album-title').innerText = "Album introuvable";
            document.getElementById('album-meta').style.display = 'none';
        }
    </script>
</body>
</html>